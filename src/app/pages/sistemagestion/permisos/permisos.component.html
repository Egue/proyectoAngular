 
<div class="row">
    <div class="col-12">
        <div class="card">
            <div class="card-body">
                 <!-- tab--> 
                 <p-tabView styleClass="tabview-custom" >
                     <p-tabPanel>
                         <ng-template pTemplate = "header" >
                             <i class="pi pi-eye"></i>
                             <span>&nbsp;Activos</span>
                         </ng-template>
                         <!--table permisos creados-->
                         <p-button icon="pi pi-plus-circle" (click)="addPermiso()" [hidden]="permisosActivos.length > 0" ></p-button>
                         <!--<p-fieldset *ngFor="let item of permisosActivos" legend="Permiso {{item.prefijo}}-{{item.indicativo}} / creado: {{item.fecha_inicio}}" [toggleable]="true"   >-->
                            <div class="bg-theme stats-bar" *ngFor="let item of permisosActivos">
                                <div class="row">
                                    <div class="col-lg-3 col-md-4">
                                        <div class="p-20 active">
                                            <h6 class="text-white">Permiso</h6>
                                            <h3 class="text-white m-b-0">{{item.prefijo}}-{{item.indicativo}}</h3>
                                        </div>
                                    </div>
                                    <div class="col-lg-3 col-md-4">
                                        <div class="p-20">
                                            <h6 class="text-white">Fecha Creación</h6>
                                            <h3 class="text-white m-b-0">{{item.fecha_inicio}}</h3>
                                        </div>
                                    </div>
                                    <div class="col-lg-3 col-md-4">
                                        <div class="p-20">
                                            <h6 class="text-white">Lugar de Trabajo</h6>
                                            <h3 class="text-white m-b-0">{{item.lugar_de_trabajo}}</h3>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <p-progressBar mode="indeterminate" [style]="{'height': '6px'}" *ngIf="cargando"></p-progressBar>
                            <br>
                            <!--accordion-->
                            <p-accordion>
                                <p-accordionTab header="I PERMISO CONCEDIDO A">
                                   <!--tabla de empleados-->
                                   <p-table [value]="listEmpleadoPermiso" responsiveLayout="scroll">
                                    <ng-template pTemplate="caption">
                                        <div class="flex align-items-center justify-content-between">
                                            
                                            <p-button icon="pi pi-plus" (click)="openModalEmpleados()"></p-button>
                                        </div>
                                    </ng-template>
                                    <ng-template pTemplate="header">
                                        <tr>
                                            <th>Nombre</th> 
                                            <th>Correo</th> 
                                            <th>Acción</th>
                                        </tr>
                                    </ng-template>
                                    <ng-template pTemplate="body" let-empleado>
                                        <tr>
                                            <td>{{empleado.user}}</td> 
                                            <td>{{empleado.email}}</td>
                                            <td><i class="mdi mdi-delete cursor" (click)="deletePermisoEmpleado(empleado)"></i> </td>
                                        </tr>
                                    </ng-template>
                                   </p-table>
                                   <!--empleados-->
                                </p-accordionTab>
                                <p-accordionTab header=" II ANÁLISIS SEGURO DE TRABAJO">
                                    <p-button icon="pi pi-plus" (click)="openModalPeligros()"></p-button>
                                    <div class="col-md-12">
                                        <div class="card  ">
                                            <div class="card-body" *ngFor="let item of listPermisoPeligro">
                                                <h4 class="card-title">
                                                    <button type="button" class="close" data-dismiss="alert" aria-label="Close" (click)="deletePermisoPeligro(item)"> <span aria-hidden="true">×</span> </button>
                                                    <span class="lstick"></span>
                                                    {{item.peligro_nombre}}
                                                    
                                                </h4>
                                                <div class="alert alert-warning">
                                                    <h3 class="text-warning"><i class="fa fa-exclamation-triangle"></i>Consecuencias</h3>
                                                    {{item.peligro_consecuencias}}
                                                </div>
                                                 
                                                <div class="alert alert-success">
                                                    <h3 class="text-success"><i class="fa fa-check-circle"></i>Controles</h3>
                                                    <ul>
                                                        <li *ngFor="let subItem of item.controles">{{subItem.nombre}}</li>
                                                    </ul>
                                                </div>
                                               
                                            </div>
                                        </div>

 
                                    </div>
                                </p-accordionTab>
                                <p-accordionTab header="III PREOPERACIONAL VEHICULO DE TRANSPORTE">
                                    <app-moto-svg></app-moto-svg>
                                </p-accordionTab>
                                
                            </p-accordion>
                            <!---->
                        <!--</p-fieldset>--> 
                         <!---->
                     </p-tabPanel>
                     <p-tabPanel header="Header II">
                         <ng-template pTemplate = "header">
                             <i class="pi pi-eye-slash"></i>
                             <span>&nbsp;Cerrados</span>
                         </ng-template>
                         <p>Sed ut perspiciatis unde omnis iste natus error sit voluptatem accusantium doloremque laudantium, totam rem aperiam, eaque ipsa quae ab illo inventore veritatis et quasi
                             architecto beatae vitae dicta sunt explicabo. Nemo enim ipsam voluptatem quia voluptas sit aspernatur aut odit aut fugit, sed quia consequuntur magni dolores eos qui ratione
                             voluptatem sequi nesciunt. Consectetur, adipisci velit, sed quia non numquam eius modi.</p>
                     </p-tabPanel>
                     
                 </p-tabView>
                 <!--fin tab-->
            </div>
        </div>
    </div>
</div> 

<!--Modal agregar un permisod e trabajo nuevo, si ya existe uno no se muestra botton-->
<div class="fondo-modal animated fadeIn fast"
[class.oculto] = "modalEstado">
<div class="modal fade none-border show" id="add-new-event" style="display: block; padding-right: 17px;">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title"><strong>Nuevo</strong> Permiso</h4>
                <button type="button" class="close"  (click)="cerrarModal()" aria-hidden="true">×</button>
            </div>
            <form [formGroup]="formPermiso" (submit) = saveClasificacion()>
            <div class="modal-body">
                
                <div class="modal-body">
                    <div class="p-fluid grid">
                        <div class="field col-12 md:col-4">
                            <p-calendar inputId="calendar"  formControlName ="fecha_inicio" class="ng-invalid ng-dirty" [showIcon]="true" [showTime]="true" [showSeconds]="true" placeholder="Fecha permiso"></p-calendar>
                        </div>
                        <br>
                        <div class="field col-12 md:col-4">
                            <p-dropdown inputId="lugar" formControlName="lugar_de_trabajo" [autoDisplayFirst]="false" [options]="lugar"  optionLabel="name" class="ng-invalid ng-dirty" placeholder="Lugar Trabajo"></p-dropdown>
                        </div>
                        <br>
                        <div class="field col-12 md:col-4">
                            <p-dropdown inputId="tipo"  (onChange) = "selectedTipo($event)" [autoDisplayFirst]="false" [options]="listTipoTrabajo" optionLabel="nombre" class="ng-invalid ng-dirty" placeholder="Tipo de Trabajo"></p-dropdown>
                        </div>
                    </div>
                    
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-danger waves-effect waves-light save-category" type="submit"  [disabled]="this.formPermiso.invalid">Guardar</button>
                    <button type="button" class="btn btn-secondary waves-effect" (click)="cerrarModal()">Cerrar</button>
                </div> 
               
            </div>
            </form>
        </div>
    </div>
</div>
</div>

<!--modal cargar empleados-->
<div class="fondo-modal animated fadeIn fast" [class.oculto] = "modalEmpleados">
    <div class="modal fade none-border  show" id="add-new-event" style="display: block; padding-right: 17px;">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                    <h4 class="modal-title"><strong>Asociar</strong> Empleado</h4>
                    <button type="button" class="close"  (click)="cerrarModalEmpleado()" aria-hidden="true">×</button>
                </div>
                <div class="modal-body">
                    <p-table
                        #dt1
                        [value] ="listEmpleados"
                        dataKey="id"
                        [loading]="loading"
                        [paginator]="true"
                        [rows] = "10"
                        responsiveLayout="scroll"
                        [showCurrentPageReport]="true"
                        currentPageReportTemplate="Motrando {first} de {last} {totalRecords} Resultados"
                        [rowsPerPageOptions]="[10,25]" 
                        styleClass="p-datatable-gridlines" 
                    >
                    <ng-template pTemplate="caption">
                        <div class="flex">
                            <button pButton label="Limpiar Filtros" class="p-button-outlined" icon="pi pi-filter-slash" (click)="clear(dt1)" ></button>
                        </div>
                    </ng-template>
                    <ng-template pTemplate="header">
                        <tr>
                             
                            <th>
                                Nombre Empleado
                            </th>  
                        </tr>
                        <tr>
                            <th>
                                <p-columnFilter type="text" field="user"></p-columnFilter>
                            </th>
                        </tr>
                    </ng-template>
                    <ng-template pTemplate="body" let-empleado>
                        <tr>
                            
                            <td  (click)="seleccionarEmpleado(empleado)" class="cursor">{{empleado.user}}</td> 
                        </tr>
                    </ng-template>
                                      

                    </p-table>
                </div>
            </div>
        </div>
    </div>
</div>

<!--cargar modal de peligros-->
<div class="fondo-modal animated fadeIn fast" [class.oculto] = "modalPeligros">
    <div id="myModal" class="modal fade show" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" style="display: block; padding-right: 15px;">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h4 class="modal-title" id="myModalLabel"><span>Agregar</span> Peligros</h4>
                    <button type="button" class="close" data-dismiss="modal" aria-hidden="true" (click)="closeModalPeligros()">×</button>
                </div>
                <div class="modal-body">
                    <p-progressBar mode="indeterminate" [style]="{'height': '6px'}" *ngIf="loadingInModal"></p-progressBar>
                   <!--categorias-->
                   <div class="card-body" *ngIf="categoriaOculta">
                    <h4 class="card-title"><span class="lstick"></span>Categorias</h4>
                    <div class="row">
                        <div class="col-md-12">
                            <div id="calendar-events">
                                <div class="calendar-events ui-draggable ui-draggable-handle"  style="position: relative;"  *ngFor="let item of listCategorias" (click) ="getListPeligros(item)" >
                                    <i class="mdi mdi-chemical-weapon"></i> {{item.nombre}}  
                                </div>
                            </div>
                      </div>
                    </div>
                </div>
                   <!--fin-->
                   <!--peligros-->
                   <div class="card-body" *ngIf="peligrosOculta">
                    <h4 class="card-title"><span class="lstick"></span>Peligros</h4>
                    <div class="row">
                        <div class="col-md-12">
                            <div id="calendar-events">
                                <div class="calendar-events ui-draggable ui-draggable-handle"  style="position: relative;"  *ngFor="let item of listPeligros" (click)="savePermisoPeligro(item)" >
                                    <i class="fa fa-warning text-danger"></i> {{item.nombre}}  
                                </div>
                            </div>
                      </div>
                    </div>
                </div>
                   <!---->
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-info waves-effect" *ngIf="peligrosOculta" (click)="modalAtrasPeligros()">Atras</button>
                    <button type="button" class="btn btn-info waves-effect" (click)="closeModalPeligros()">Cerrar</button>
                </div>
            </div>
            <!-- /.modal-content -->
        </div>
        <!-- /.modal-dialog -->
    </div>
</div>